---
- name: Testing ansible-vault and secrets
  hosts: all
  become: yes

  vars:
    admin_password: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      34323930646332323631656234653931373336623061626661323432633361613964356335356435
      3030643531363062656535353437616636323137666364620a623461633364383664393338343761
      32383839313434313230666434643564646162623233396332366531303665646563323261636230
      3965616265613363390a396437663834376338386539613637393039353232656231396638366162
      35396335323165616631663064313165636232353161306533366135326634346465

  tasks:
  - name: Install package tree
    yum: name=tree state=latest

  - name: Create config file
    copy:
      dest: "/home/myconfig.conf"
      content: |
        port = 9092
        log = 7days
        home = /opt/kafka/bin
        user = admin
        password: {{ admin_password }}
